SELECT c, AVG(id), SUM(AVG(id)) OVER w 
FROM testAB
GROUP BY c 
HAVING c=(SELECT c FROM justA LIMIT 1) OR c='B' OR c IS NULL
WINDOW w AS (ROWS UNBOUNDED PRECEDING) 
ORDER BY c DESC