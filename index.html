<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src\site\markdown/index.md at 2022-10-14
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>sql-explainerator &#x2013; sql-explainerator</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>sql-explainerator</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2022-10-14<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 0.0.4-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="apidocs/index.html?allpackages-index.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-down"></span>Project Information</a>
     <ul class="nav nav-list">
      <li><a href="ci-management.html" title="CI Management"><span class="none"></span>CI Management</a></li>
      <li><a href="dependencies.html" title="Dependencies"><span class="none"></span>Dependencies</a></li>
      <li><a href="dependency-info.html" title="Dependency Information"><span class="none"></span>Dependency Information</a></li>
      <li><a href="dependency-management.html" title="Dependency Management"><span class="none"></span>Dependency Management</a></li>
      <li><a href="distribution-management.html" title="Distribution Management"><span class="none"></span>Distribution Management</a></li>
      <li class="active"><a href="#"><span class="none"></span>About</a></li>
      <li><a href="licenses.html" title="Licenses"><span class="none"></span>Licenses</a></li>
      <li><a href="mailing-lists.html" title="Mailing Lists"><span class="none"></span>Mailing Lists</a></li>
      <li><a href="plugin-management.html" title="Plugin Management"><span class="none"></span>Plugin Management</a></li>
      <li><a href="plugins.html" title="Plugins"><span class="none"></span>Plugins</a></li>
      <li><a href="scm.html" title="Source Code Management"><span class="none"></span>Source Code Management</a></li>
      <li><a href="summary.html" title="Summary"><span class="none"></span>Summary</a></li>
      <li><a href="team.html" title="Team"><span class="none"></span>Team</a></li>
     </ul></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" title="Built by Maven" class="builtBy"><img class="builtBy"  alt="Built by Maven" src="images/logos/maven-feather.png"    /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>sql-explainerator</h1>
<p><b>sql-explainerator</b>  converts query execution plans ( the output from an &#x2018;EXPLAIN&#x2019; statement ) into pretty diagrams</p>
<p>It attempts to recreate the type of diagrams you get from the &#x2018;visual explain&#x2019; pane in <a class="externalLink" href="https://www.mysql.com/products/workbench/">MySQL Workbench</a>, and looks like this:</p>
<p><img src="https://raw.githubusercontent.com/randomnoun/sql-explainerator/master/src/site/resources/img/sakila-7g.png" alt="" /></p>
<p>The images are SVG, although you can also generate HTML output which wraps the SVG.</p><section>
<h2><a name="Why_would_anyone_want_to_do_that__.3F"></a>Why would anyone want to do that  ?</h2>
<p>Because diagrams are easier to comprehend than the tabular or JSON &#x2018;explain&#x2019; output you get in MySQL.</p>
<p>And becaue it&#x2019;s in java, so I might be able to hook it into a running app server to generate these things on the fly rather than having to start up MySQL Workbench and cut and paste SQL across in order to click the explain query button on that.</p>
<p>And, of course, because I&#x2019;m a man, and apparently I live for explaining things.</p></section><section>
<h2><a name="Can_I_see_some_pictures_.3F"></a>Can I see some pictures ?</h2>
<p>Sure.</p>
<p>Here&#x2019;s some examples of the sort of output it generates.</p>
<p>Both the SVG and HTML contain javascript to display the tooltips, but you can produce output without the javascript, if that&#x2019;s your bag.</p>
<p>The Workbench output is for comparison, and was created by taking some screenshots of Workbench 8.0.30 running against MySQL Server 8.0.27, both on Windows. The :poop: symbol represents particularly shithouse output.</p>
<p>| Name | Output<br />HTML | Output<br />SVG | Input<br />SQL | Input<br />JSON | Workbench<br />Comparison | Blurb | |&#x2013;|:&#x2013;:|:&#x2013;:|:&#x2013;:|:&#x2013;:|:&#x2013;:|&#x2013;| | sakila-1 | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-1-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-1-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-1.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-1.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/sakila-1.png">PNG</a> | simple SELECT | | sakila-4a | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-4a-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-4a-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-4a.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-4a.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/sakila-4a.png">PNG</a> | grouping, ordering | | sakila-6a | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-6a-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-6a-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-6a.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-6a.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/sakila-6a.png">PNG</a> | joined tables | | sakila-6b | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-6b-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-6b-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-6b.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-6b.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/sakila-6b.png">PNG</a> | joined tables, grouping | | sakila-7g | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-7g-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/sakila-7g-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-7g.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/sakila-7g.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/sakila-7g.png">PNG</a> | joined subqueries | | having-1 | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/having-1-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/having-1-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/having-1.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/having-1.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/having-1.png">PNG</a> :poop: | group by, having subquery | | having-2 | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/having-2-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/having-2-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/having-2.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/having-2.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/having-2.png">PNG</a> :poop: | subquery + having subquery | | insert-1 | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/insert-1-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/insert-1-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/insert-1.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/insert-1.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/insert-1.png">PNG</a> :poop: | insert into | | window-1 | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/window-1-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/window-1-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/window-1.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/window-1.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/window-1.png">PNG</a> :poop: | window function | | window-3 | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/window-3-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/window-3-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/window-3.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/window-3.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/window-2.png">PNG</a> :poop: | grouped window function | | window-4 | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/window-4-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/window-4-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/window-4.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/window-4.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/window-3.png">PNG</a> :poop: | named windows, subqueries | | window-5 | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/window-5-javascript.html">HTML</a> |  <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/output/window-5-javascript.svg">SVG</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/window-5.sql.txt">SQL</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/test/input/window-5.json">JSON</a> | <a class="externalLink" href="https://randomnoun.github.io/sql-explainerator/img/workbench/window-4.png">PNG</a> :poop: :poop: | window partitions |</p></section><section>
<h2><a name="How_do_I_use_it_.3F"></a>How do I use it ?</h2>
<p>If you&#x2019;re running this from Java code, take a look at the <a class="externalLink" href="https://github.com/randomnoun/sql-explainerator/blob/main/src/test/java/com/randomnoun/common/db/explain/SimpleTest.java">SimpleTest</a></p>
<p>If you&#x2019;re running this from the command-line:</p>

<div>
<div>
<pre class="source">C:\util\java&gt; java -jar sql-explainerator-0.0.3-cli.jar --help
usage: SqlExplaineratorCli [options]
 -h,--help                  This usage text
 -i,--infile &lt;infile&gt;       input file, or '-' for stdin; default = stdin
 -o,--outfile &lt;outfile&gt;     output file, or '-' for stdout; default = stdout
 -l,--layout &lt;layout&gt;       layout format (workbench or explainerator); default = explainerator
 -f,--format &lt;format&gt;       output format (svg or html); default = svg
 -t,--tooltip &lt;tooltip&gt;     tooltip type (none, title, attribute, javascript); default = title
 -j,--jdbc &lt;jdbc&gt;           JDBC connection string
 -u,--username &lt;username&gt;   JDBC username
 -p,--password &lt;password&gt;   JDBC password
 -d,--driver &lt;driver&gt;       JDBC driver class name; default = org.mariadb.jdbc.Driver
 -q,--sql &lt;sql&gt;             SQL to explain
 -c,--css &lt;css&gt;             alternate css file
 -s,--script &lt;script&gt;       alternate javascript file

This command will convert a MySQL JSON execution plan into an SVG diagram.
There are two layout methods: 'workbench' which will try to mimic the diagrams generated from MySQL
Workbench, or 'explainerator', which adds support for inserts, 'having' clauses, and window functions.

The execution plan can be supplied via stdin or --infile (Example 1), or can be retrieved from a
MySQL server (Example 2).

Example 1: To generate the query plan JSON, execute an 'EXPLAIN FORMAT=JSON' statement:

  mysql --user=root --password=abc123 --silent --raw --skip-column-names \
    --execute &quot;EXPLAIN FORMAT=JSON SELECT 1 FROM DUAL&quot; sakila &gt; plan.json

then to generate the SVG diagram, supply this JSON as input to SqlExplaineratorCli:

  SqlExplaineratorCli --infile plan.json --outfile plan.svg
or
  cat plan.json | SqlPlainToImageCli &gt; plan.svg


Example 2: To generate the diagram from an SQL statement, you will need to also supply a JDBC
connection string and any credentials required to connect, e.g.:

  SqlExplaineratorCli --jdbc jdbc:mysql://localhost/sakila --username root --password abc123 \
    --sql &quot;SELECT 1 fROM DUAL&quot; --outfile plan.svg
</pre></div></div>

<p>And some example command-lines (new-lines added for readability):</p>

<div>
<div>
<pre class="source">C:\util\java&gt; java -jar sql-explainerator-0.0.3-SNAPSHOT-cli.jar 
  --jdbc jdbc:mysql://localhost/sakila --username root --password abc123 
  --sql &quot;SELECT 1 fROM DUAL&quot; --outfile plan.svg
</pre></div></div>

<div>
<div>
<pre class="source">C:\util\java&gt;&quot;c:\Program Files\MySQL\MySQL Server 8.0\bin\mysql&quot; 
  --user=root --password=abc123 --silent --raw --skip-column-names 
  --execute &quot;EXPLAIN FORMAT=JSON SELECT 1 FROM DUAL&quot; sakila &gt; plan.json

C:\util\java&gt;java -jar sql-explainerator-0.0.3-SNAPSHOT-cli.jar 
  --infile plan.json --outfile plan.svg
</pre></div></div>
</section><section>
<h2><a name="Where_can_I_get_it_.3F"></a>Where can I get it ?</h2>
<p>It&#x2019;s available in maven with the groupId:artifactId of <code>com.randomnoun.db:sql-explainerator</code>.</p>
<p>There&#x2019;s a <code>sql-explainerator-0.0.3-cli.jar</code> which has all the maven dependencies baked in if you&#x2019;re calling this from a CLI.</p>
<p>You can add it to your pom.xml using the snippet:</p>

<div>
<div>
<pre class="source">&lt;dependency&gt;
  &lt;groupId&gt;com.randomnoun.db&lt;/groupId&gt;
  &lt;artifactId&gt;sql-explainerator&lt;/artifactId&gt;
  &lt;version&gt;0.0.3&lt;/version&gt;
&lt;/dependency&gt;
</pre></div></div>

<p>but maybe check what the <a class="externalLink" href="https://search.maven.org/search?q=a:sql-explainerator">latest version is up on central</a>.</p></section><section>
<h2><a name="What_databases_can_I_run_this_on_.3F"></a>What databases can I run this on ?</h2>
<p>MySQL</p></section><section>
<h2><a name="Doesn.E2.80.99t_this_already_exist_.3F"></a>Doesn&#x2019;t this already exist ?</h2>
<p>Well, MySQL Workbench exists, but that&#x2019;s not so easy to use from within a webapp.</p>
<p>But yes, you&#x2019;d imagine this would already exist somewhere, wouldn&#x2019;t you.</p></section><section>
<h2><a name="Don.E2.80.99t_you_normally_crap_on_about_your_git_projects_on_the_blog_.3F"></a>Don&#x2019;t you normally crap on about your git projects on the blog ?</h2>
<p><a class="externalLink" href="http://www.randomnoun.com/wp/2022/10/09/make-a-new-plan-stan/">Indeed I do</a>.</p></section><section>
<h2><a name="Further_reading"></a>Further reading</h2>
<ul>

<li>MariaDB EXPLAIN is not MySQL EXPLAIN: <a class="externalLink" href="https://mariadb.com/kb/en/explain-format-json-differences/">https://mariadb.com/kb/en/explain-format-json-differences/</a></li>
<li>More of that: <a class="externalLink" href="https://mariadb.com/kb/en/differences-between-the-mysql-and-mariadb-query-optimizer/">https://mariadb.com/kb/en/differences-between-the-mysql-and-mariadb-query-optimizer/</a></li>
<li>More MariaDB EXPLAIN things: <a class="externalLink" href="https://mariadb.com/kb/en/explain-format-json/">https://mariadb.com/kb/en/explain-format-json/</a></li>
<li>More MariaDB EXPLAIN things, in blog form: <a class="externalLink" href="https://web.archive.org/web/20200218115814/http://s.petrunia.net/blog/?p=93">https://web.archive.org/web/20200218115814/http://s.petrunia.net/blog/?p=93</a></li>
<li>A not very useful EXPLAIN visualiser project: <a class="externalLink" href="https://github.com/Preetam/explain-analyzer">https://github.com/Preetam/explain-analyzer</a></li>
<li>Some EXPLAIN JSON tests from the mysql-server source: <a class="externalLink" href="https://github.com/mysql/mysql-server/blob/8d8c986e5716e38cb776b627a8eee9e92241b4ce/mysql-test/r/window_std_var_optimized.result">https://github.com/mysql/mysql-server/blob/8d8c986e5716e38cb776b627a8eee9e92241b4ce/mysql-test/r/window_std_var_optimized.result</a></li>
<li>Some more of those: <a class="externalLink" href="https://github.com/mysql/mysql-server/search?p=2&amp;q=ordering_operation">https://github.com/mysql/mysql-server/search?p=2&amp;q=ordering_operation</a></li>
</ul></section><section>
<h2><a name="Licensing"></a>Licensing</h2>
<p>sql-explainerator is licensed under the BSD 2-clause license.</p></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2022-07-22&#x2013;2022
<a href="http://www.randomnoun.com">randomnoun</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>